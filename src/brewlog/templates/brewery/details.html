{% extends "brewery/base.html" %}
{% import "macros/forms.html" as forms %}

{% block headpagetitle %}{{ brewery.name }}{% endblock %}

{% set can_edit = current_user == brewery.brewer %}

{% block content %}
<h3>{{ brewery.name }}</h3>
{% if can_edit %}
<p>Możesz zmienić dane swojego browaru używając poniższego formularza.</p>
{{ forms.render_form(form, url_for('brewery.details', brewery_id=brewery.id)) }}
{% else %}
<dl>
  <dt>Nazwa</dt><dd>{{ brewery.name }}</dd>
  <dt>Data ustanowienia</dt><dd>{{ brewery.established_date|dateformat('short') }}</dd>
  <dt>Data rejestracji</dt><dd>{{ brewery.created|dateformat('short') }}</dd>
</dl>
{% endif %}
<h3>Najnowsze warki</h3>
{% with only_public = can_edit %}
<table class="table is-striped">
  <thead>
    <tr>
      <th scope="col">Data warzenia</th>
      <th scope="col">Nazwa</th>
      <th scope="col">Styl</th>
    </tr>
  </thead>
  <tbody>
    {% for brew in utils.recent_brews(public_only=only_public) %}
    <tr>
      <td>{% if brew.date_brewed %}{{ brew.date_brewed|dateformat("short") }}{% else %}jeszcze nie uwarzona{% endif %}</td>
      <td><a href="{{ url_for('brew.details', brew_id=brew.id) }}">{{ brew.name }}</a></td>
      <td>{% if brew.style %}{{ brew.style }}{% else %}bezstylowiec{% endif %}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endwith %}
<p><a href="{{ url_for('brewery.brews', brewery_id=brewery.id) }}">wszystkie warki</a></p>

{% if can_edit %}
<p><a href="{{ url_for('brew.add') }}" class="button is-primary">dodaj nową warkę</a></p>
{% endif %}
{% endblock %}
